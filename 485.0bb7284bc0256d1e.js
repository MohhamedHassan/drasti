"use strict";(self.webpackChunkdrasti=self.webpackChunkdrasti||[]).push([[485],{4485:(Xt,T,_)=>{_.r(T),_.d(T,{ClassDetailsModule:()=>Wt});var f=_(9808),x=_(6115),v=_(8879),S=_(259),p=_(6197),t=_(5e3),J=_(2290),Z=_(8174),I=_(377),A=_(2095),b=_(2313),Q=_(8177),N=_(2104),O=_(8424),C=_(7259),j=_(1819),U=_(8067);function Y(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",5),t.NdJ("click",function(){return t.CHM(e),t.oxw().cancelREcord()}),t._UZ(1,"i",6),t.qZA()}}function F(i,o){1&i&&t._UZ(0,"span",7)}function R(i,o){if(1&i&&(t.TgZ(0,"p",13)(1,"span",14)(2,"span"),t._uU(3),t.ALo(4,"number"),t.qZA()()()),2&i){const e=t.oxw(2);t.xp6(3),t.AsE("",e.recordTime,":",t.xi3(4,2,e.recordSeconds,"2.0"),"")}}function H(i,o){1&i&&t._UZ(0,"span",7)}function q(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"i",15),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).startRecording()}),t.qZA()}}function B(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"i",16),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).pauseRecording()}),t.qZA()}}function P(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"i",17),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).resumeRecording()}),t.qZA()}}function $(i,o){if(1&i&&(t.ynx(0),t.YNc(1,R,5,5,"p",8),t.YNc(2,H,1,0,"span",2),t.TgZ(3,"button",9),t.YNc(4,q,1,0,"i",10),t.YNc(5,B,1,0,"i",11),t.YNc(6,P,1,0,"i",12),t.qZA(),t.BQk()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",0!=e.recordingStatus),t.xp6(1),t.Q6J("ngIf",0!=e.recordingStatus),t.xp6(2),t.Q6J("ngIf",0==e.recordingStatus),t.xp6(1),t.Q6J("ngIf",0!=e.recordingStatus&&!e.paused),t.xp6(1),t.Q6J("ngIf",0!=e.recordingStatus&&e.paused)}}function E(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"div",18),t.NdJ("click",function(){return t.CHM(e),t.oxw().stopRecording()}),t._UZ(1,"i",19),t.qZA()}}let L=(()=>{class i{constructor(e){this.cdr=e,this.recording=!1,this.audioChunks=[],this.paused=!1,this.nowRecording=new t.vpe,this.send=new t.vpe,this.micError=new t.vpe,this.recordingStatus=0,this.hideOptions=!1,this.recordTime=0,this.recordSeconds=0,this.cancel=!1}startRecording(){this.recordingStatus=1,navigator.mediaDevices.getUserMedia({audio:!0}).then(e=>{this.mediaRecorder=new MediaRecorder(e),this.mediaRecorder.start(),this.mediaStream=e,this.hideOptions=!1,this.recording=!0,this.interval=setInterval(()=>{60==this.recordSeconds?(this.recordSeconds=0,this.recordTime+=1):this.recordSeconds+=1},1e3),this.nowRecording.emit(!0),this.mediaRecorder.ondataavailable=s=>{this.audioChunks.push(s.data)},this.mediaRecorder.onstop=()=>{if(this.recording){this.recording=!1;const s=new Blob(this.audioChunks,{type:"audio/webm"});this.audioChunks=[],this.send.emit(s),this.audioChunks=[]}this.stopMediaStream()}}).catch(e=>{this.recordingStatus=0,this.micError.emit(!0)})}pauseRecording(){this.mediaRecorder&&"recording"===this.mediaRecorder.state&&(clearInterval(this.interval),this.mediaRecorder.pause(),this.paused=!0)}resumeRecording(){this.mediaRecorder&&"paused"===this.mediaRecorder.state&&(this.interval=setInterval(()=>{60==this.recordSeconds?(this.recordSeconds=0,this.recordTime+=1):this.recordSeconds+=1},1e3),this.mediaRecorder.resume(),this.paused=!1)}stopRecording(){this.mediaRecorder&&this.recording&&(clearInterval(this.interval),this.recordTime=0,this.recordSeconds=0,this.mediaRecorder.stop(),this.paused=!1,this.recordingStatus=0,this.nowRecording.emit(!1))}convertBlobToBase64(e){return new Promise((s,n)=>{const l=new FileReader;l.readAsDataURL(e),l.onloadend=()=>{s(l.result)},l.onerror=n})}cancelREcord(){this.recording=!1,this.audioChunks=[],this.audioUrl="",this.paused=!1,this.nowRecording.emit(!1),this.recordingStatus=0,this.recordTime=0,this.recordSeconds=0,this.cdr.detectChanges(),this.stopMediaStream(),this.interval&&clearInterval(this.interval)}stopMediaStream(){this.mediaStream&&this.mediaStream.getTracks().forEach(e=>e.stop())}ngOnDestroy(){this.stopMediaStream()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(t.sBO))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-audio-chat"]],inputs:{cancel:"cancel"},outputs:{nowRecording:"nowRecording",send:"send",micError:"micError"},decls:5,vars:4,consts:[[1,"d-flex","align-items-center","justify-content-end","w-100"],["class","recordbtn",3,"click",4,"ngIf"],["class","mx-2",4,"ngIf"],[4,"ngIf"],["class","whit mx-2",3,"click",4,"ngIf"],[1,"recordbtn",3,"click"],[1,"fa-solid","fa-trash-can","icnColor"],[1,"mx-2"],["style","min-width: 100px","class","m-0",4,"ngIf"],[1,"recordbtn"],["class","fa-solid fa-microphone icnColor",3,"click",4,"ngIf"],["class","fa-regular fa-circle-pause redcolor",3,"click",4,"ngIf"],["class","fa-solid fa-microphone redcolor",3,"click",4,"ngIf"],[1,"m-0",2,"min-width","100px"],[2,"min-width","30px","display","inline-block"],[1,"fa-solid","fa-microphone","icnColor",3,"click"],[1,"fa-regular","fa-circle-pause","redcolor",3,"click"],[1,"fa-solid","fa-microphone","redcolor",3,"click"],[1,"whit","mx-2",3,"click"],[1,"fa-solid","fa-paper-plane"]],template:function(e,s){1&e&&(t.TgZ(0,"div",0),t.YNc(1,Y,2,0,"button",1),t.YNc(2,F,1,0,"span",2),t.YNc(3,$,7,5,"ng-container",3),t.YNc(4,E,2,0,"div",4),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",0!=s.recordingStatus),t.xp6(1),t.Q6J("ngIf",0!=s.recordingStatus),t.xp6(1),t.Q6J("ngIf",!s.hideOptions),t.xp6(1),t.Q6J("ngIf",0!=s.recordingStatus&&s.recordSeconds>0))},directives:[f.O5],pipes:[f.JJ],styles:[".recordbtn[_ngcontent-%COMP%]{background-color:transparent!important;padding:0!important;border:none}.icnColor[_ngcontent-%COMP%]{color:#0034c2!important;font-size:1.3rem}.redcolor[_ngcontent-%COMP%]{font-size:1.3rem;color:red}.whit[_ngcontent-%COMP%]{cursor:pointer;background-color:#0034c2;width:2rem;height:2rem;border-radius:50%;display:flex;justify-content:center;align-items:center}.whit[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem;color:#fff}.gry[_ngcontent-%COMP%]{vertical-align:middle;font-size:2rem;color:#d8d3d3}"]}),i})();const z=["boxchat2"],V=function(i,o){return{background:i,color:o}};function G(i,o){if(1&i&&(t.TgZ(0,"span",15),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit,s=t.oxw();t.Q6J("ngStyle",t.WLB(2,V,s.userid==(null==e?null:e.from_id)?"#0d6efd":"#e4e6eb",s.userid==(null==e?null:e.from_id)?"white":"black")),t.xp6(1),t.hij(" ",null==e?null:e.message_content," ")}}const k=function(i){return{"text-align":i}};function K(i,o){if(1&i&&(t.TgZ(0,"div",16),t._UZ(1,"img",17),t.qZA()),2&i){const e=t.oxw().$implicit,s=t.oxw();t.Q6J("ngStyle",t.VKq(2,k,s.userid==(null==e?null:e.from_id)?"left":"right")),t.xp6(1),t.Q6J("src",null==e?null:e.message_content,t.LSH)}}const W=function(i){return{"justify-content":i}};function X(i,o){if(1&i&&(t.TgZ(0,"div",18)(1,"audio",19),t._UZ(2,"source",20),t._uU(3," Your browser does not support the audio element. "),t.qZA()()),2&i){const e=t.oxw().$implicit,s=t.oxw();t.Q6J("ngStyle",t.VKq(2,W,s.userid==(null==e?null:e.from_id)?"flex-end":"flex-start")),t.xp6(2),t.Q6J("src",null==e?null:e.message_content,t.LSH)}}function tt(i,o){if(1&i&&(t.TgZ(0,"li",11),t.YNc(1,G,2,5,"span",12),t.YNc(2,K,2,4,"div",13),t.YNc(3,X,4,4,"div",14),t.qZA()),2&i){const e=o.$implicit,s=t.oxw();t.Q6J("ngStyle",t.VKq(4,k,s.userid==(null==e?null:e.from_id)?"left":"right")),t.xp6(1),t.Q6J("ngIf","text"==(null==e?null:e.type)),t.xp6(1),t.Q6J("ngIf","photo"==(null==e?null:e.type)),t.xp6(1),t.Q6J("ngIf","audio"==(null==e?null:e.type))}}function et(i,o){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"app-audio-chat",21),t.NdJ("micError",function(){return t.CHM(e),t.oxw().micrphonAlert=!0})("send",function(n){return t.CHM(e),t.oxw().sendAudio(n)})("nowRecording",function(n){return t.CHM(e),t.oxw().nowRecording=n}),t.qZA(),t.BQk()}}function it(i,o){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",22),t._UZ(2,"i",23),t.TgZ(3,"input",24),t.NdJ("input",function(n){return t.CHM(e),t.oxw().onImageChange(n)}),t.qZA()(),t.TgZ(4,"input",25,26),t.NdJ("keyup.enter",function(){t.CHM(e);const n=t.MAs(5);return t.oxw().sendMessage(n)}),t.qZA(),t.TgZ(6,"i",27),t.NdJ("click",function(){t.CHM(e);const n=t.MAs(5);return t.oxw().sendMessage(n)}),t.qZA(),t.BQk()}}function st(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"div",28)(1,"div",29)(2,"h2"),t._uU(3,"\u0627\u0644\u0633\u0645\u0627\u062d \u0644\u0644\u0645\u064a\u0643\u0631\u0648\u0641\u0648\u0646"),t.qZA(),t.TgZ(4,"p"),t._uU(5," \u0644\u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u0631\u0633\u0627\u0626\u0644 \u0627\u0644\u0635\u0648\u062a\u064a\u0629\u060c \u064a\u062d\u062a\u0627\u062c \u062f\u0631\u0627\u0633\u062a\u064a \u0625\u0644\u0649 \u0627\u0644\u0648\u0635\u0648\u0644 \u0625\u0644\u0649 \u0627\u0644\u0645\u064a\u0643\u0631\u0648\u0641\u0648\u0646 \u0627\u0644\u062e\u0627\u0635 \u0628\u0643. \u0627\u0646\u0642\u0631 \u0641\u0648\u0642 \u0634\u0631\u064a\u0637 URL \u0648\u0627\u062e\u062a\u0631 \u0627\u0644\u0633\u0645\u0627\u062d \u062f\u0627\u0626\u0645\u064b\u0627 \u0628\u0627\u0644\u0648\u0635\u0648\u0644 \u0625\u0644\u0649 \u0627\u0644\u0645\u064a\u0643\u0631\u0648\u0641\u0648\u0646 \u0627\u0644\u062e\u0627\u0635 \u0628\u0643. "),t.qZA(),t.TgZ(6,"div",30)(7,"button",31),t.NdJ("click",function(){return t.CHM(e),t.oxw().micrphonAlert=!1}),t._uU(8," \u062d\u0633\u0646\u0627\u064b "),t.qZA()()()()}}let nt=(()=>{class i{constructor(e,s,n,l,a){this.angularFireStore=e,this.datepipe=s,this.afs=n,this.title=l,this.classDetailsService=a,this.micrphonAlert=!1,this.nowRecording=!1,this.showaudio=!0,this.messages=[],this.closeChat=new t.vpe,this.currentUserMessages=[]}scrollChatBox(){setTimeout(()=>{this.boxchat&&(this.boxchat.nativeElement.scrollTop=this.boxchat.nativeElement.scrollHeight)},10)}ngAfterViewInit(){this.scrollChatBox()}onImageChange(e){var s;const n=null===(s=null==e?void 0:e.target)||void 0===s?void 0:s.files[0];let l=this.angularFireStore.ref(`message_images/photo_message_${this.datepipe.transform(new Date,"yyyy-MM-dd HH:mm:ss")}`);l.put(n).then(()=>{l.getDownloadURL().subscribe(a=>{var c,r,d,u;let g=new Date;(0,p.t8)((0,p.iH)(this.db,`Subjects-Messages/${null===(c=this.classDetails)||void 0===c?void 0:c.id}/${localStorage.getItem("userid")}/${this.afs.createId()}`),{date:this.datepipe.transform(g,"yyyy-MM-dd HH:mm:ss"),did_read:!1,from:localStorage.getItem("username"),from_number:localStorage.getItem("userphone"),from_id:localStorage.getItem("userid"),message_content:a,material_name:null===(r=this.classDetails)||void 0===r?void 0:r.name,to:null===(d=this.classDetails)||void 0===d?void 0:d.name,to_id:`${null===(u=this.classDetails)||void 0===u?void 0:u.id}`,type:"photo"}).then(()=>{var h;this.classDetailsService.addQuestion({material_id:null===(h=this.classDetails)||void 0===h?void 0:h.id,question:"\u0635\u0648\u0631\u0629"}).subscribe(),setTimeout(()=>{this.handleAutoReplyIfNeeded(this.currentUserMessages)},1e3)})})})}sendAudio(e){this.nowRecording=!1;let s=this.angularFireStore.ref(`message_images/voice_message_${this.datepipe.transform(new Date,"yyyy-MM-dd HH:mm:ss")}`);s.put(e).then(()=>{s.getDownloadURL().subscribe(n=>{var l,a,c,r;let d=new Date;(0,p.t8)((0,p.iH)(this.db,`Subjects-Messages/${null===(l=this.classDetails)||void 0===l?void 0:l.id}/${localStorage.getItem("userid")}/${this.afs.createId()}`),{date:this.datepipe.transform(d,"yyyy-MM-dd HH:mm:ss"),did_read:!1,from:localStorage.getItem("username"),from_number:localStorage.getItem("userphone"),from_id:localStorage.getItem("userid"),message_content:n,material_name:null===(a=this.classDetails)||void 0===a?void 0:a.name,to:null===(c=this.classDetails)||void 0===c?void 0:c.name,to_id:`${null===(r=this.classDetails)||void 0===r?void 0:r.id}`,type:"audio"}).then(()=>{var u;this.classDetailsService.addQuestion({material_id:null===(u=this.classDetails)||void 0===u?void 0:u.id,question:"\u0631\u0633\u0627\u0644\u0629 \u0635\u0648\u062a\u064a\u0629"}).subscribe(),setTimeout(()=>{this.handleAutoReplyIfNeeded(this.currentUserMessages)},1e3)})})})}ngOnInit(){var e;this.app=(0,S.ZF)({apiKey:"AIzaSyCrZO0tF5O5Ms8au460-tmGbNS3mJ6QrEc",authDomain:"drasti-37a06.firebaseapp.com",databaseURL:"https://drasti-37a06-default-rtdb.firebaseio.com",projectId:"drasti-37a06",storageBucket:"drasti-37a06.appspot.com",messagingSenderId:"850147128578",appId:"1:850147128578:web:2153add74417b85d4fbe1b",measurementId:"G-41JEDDFQT2"}),this.db=(0,p.N8)(this.app),window.scroll(0,0),this.title.setTitle(" \u062f\u0631\u0627\u0633\u062a\u064a - \u0627\u062f\u0631\u0633 \u0648\u0627\u0646\u062a \u0645\u062a\u0637\u0645\u0646 "),this.authRef=(0,p.iH)(this.db,`Subjects-Messages/${null===(e=this.classDetails)||void 0===e?void 0:e.id}/${localStorage.getItem("userid")}`),(0,p.jM)(this.authRef,s=>{if(this.messages=[],localStorage.getItem("drastitoken")){let l=s.val();if(l){let a=l;this.currentUserMessages=l,a&&(this.messages=Object.values(a),this.messages=this.messages.sort(function(c,r){return new Date(c.date)-new Date(r.date)}))}setTimeout(()=>{this.boxchat&&(this.boxchat.nativeElement.scrollTop=this.boxchat.nativeElement.scrollHeight)},10)}})}sendMessage(e){var s,n,l,a;let c=e.value;if(c.toString().trim().length>0){let r=new Date;(0,p.t8)((0,p.iH)(this.db,`Subjects-Messages/${null===(s=this.classDetails)||void 0===s?void 0:s.id}/${localStorage.getItem("userid")}/${this.afs.createId()}`),{did_read:!1,date:this.datepipe.transform(r,"yyyy-MM-dd HH:mm:ss"),from:localStorage.getItem("username"),from_number:localStorage.getItem("userphone"),from_id:localStorage.getItem("userid"),message_content:c,material_name:null===(n=this.classDetails)||void 0===n?void 0:n.name,to:null===(l=this.classDetails)||void 0===l?void 0:l.name,to_id:`${null===(a=this.classDetails)||void 0===a?void 0:a.id}`,type:"text"}).then(()=>{var d;this.classDetailsService.addQuestion({material_id:null===(d=this.classDetails)||void 0===d?void 0:d.id,question:c}).subscribe(),setTimeout(()=>{this.handleAutoReplyIfNeeded(this.currentUserMessages)},1e3)}),e.value=""}}get userid(){return localStorage.getItem("userid")}ngOnDestroy(){var e,s,n;if(null===(e=this.currentUserMessages)||void 0===e?void 0:e.length)for(let l=0;l<(null===(s=this.currentUserMessages)||void 0===s?void 0:s.length);l++){const a=this.currentUserMessages[l];if(a.from_id!==localStorage.getItem("userid")&&!1===a.did_read){const r=(0,p.iH)(this.db,`Subjects-Messages/${null===(n=this.classDetails)||void 0===n?void 0:n.id}/${localStorage.getItem("userid")}/${l}`);(0,p.Vx)(r,{did_read:!0})}}this.authRef&&(0,p.S1)(this.authRef)}handleAutoReplyIfNeeded(e){var s;const n=new Date;if(!Object.values(e).some(a=>"_1"==a.from_id&&this.datepipe.transform(a.date,"yyyy-MM-dd")===this.datepipe.transform(n,"yyyy-MM-dd"))){const a=this.afs.createId(),c=(0,p.iH)(this.db,`Subjects-Messages/${this.classDetails.id}/${localStorage.getItem("userid")}/${a}`),r={from:"\u0627\u0644\u0631\u062f \u0627\u0644\u0627\u0644\u064a",from_id:"_1",from_number:localStorage.getItem("userphone"),to:localStorage.getItem("username"),to_id:`${localStorage.getItem("userid")}`,date:this.datepipe.transform(new Date,"yyyy-MM-dd HH:mm:ss"),message_content:"\u0627\u0647\u0644\u0627 \u0628\u0643 \u0641\u064a \u062a\u0637\u0628\u064a\u0642 \u062f\u0631\u0627\u0633\u062a\u064a\n\u0633\u064a\u0642\u0648\u0645 \u0627\u0639\u0636\u0627\u0621 \u0647\u064a\u0626\u0629 \u0627\u0644\u062a\u062f\u0631\u064a\u0633 \u0628\u0627\u0644\u0631\u062f \u0639\u0644\u064a \u0633\u064a\u0627\u062f\u062a\u0643\u0645 \u062e\u0644\u0627\u0644 \u0662\u0664 \u0633\u0627\u0639\u0629\n\u0634\u0643\u0631\u0627 \u0644\u0627\u0633\u062a\u062e\u062f\u0627\u0645 \u062f\u0631\u0627\u0633\u062a\u064a",type:"text",did_read:!1,material_name:null===(s=this.classDetails)||void 0===s?void 0:s.name};(0,p.t8)(c,r).then(()=>{var d;this.classDetailsService.addAnswer({material_id:null===(d=this.classDetails)||void 0===d?void 0:d.id,answer:"\u0627\u0647\u0644\u0627 \u0628\u0643 \u0641\u064a \u062a\u0637\u0628\u064a\u0642 \u062f\u0631\u0627\u0633\u062a\u064a\n\u0633\u064a\u0642\u0648\u0645 \u0627\u0639\u0636\u0627\u0621 \u0647\u064a\u0626\u0629 \u0627\u0644\u062a\u062f\u0631\u064a\u0633 \u0628\u0627\u0644\u0631\u062f \u0639\u0644\u064a \u0633\u064a\u0627\u062f\u062a\u0643\u0645 \u062e\u0644\u0627\u0644 \u0662\u0664 \u0633\u0627\u0639\u0629\n\u0634\u0643\u0631\u0627 \u0644\u0627\u0633\u062a\u062e\u062f\u0627\u0645 \u062f\u0631\u0627\u0633\u062a\u064a",student_id:localStorage.getItem("userid")}).subscribe()})}}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(I.Q1),t.Y36(f.uU),t.Y36(A.ST),t.Y36(b.Dx),t.Y36(Z._))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-subject-chat"]],viewQuery:function(e,s){if(1&e&&t.Gf(z,5),2&e){let n;t.iGM(n=t.CRH())&&(s.boxchat=n.first)}},inputs:{classDetails:"classDetails"},outputs:{closeChat:"closeChat"},decls:13,vars:4,consts:[[1,"chatbox"],[1,"header","px-3","py-2","d-flex","align-items-center","justify-content-between",2,"border-bottom","1px solid #cfcfcf"],[1,"fw-bold"],[1,"fa-solid","fa-x",2,"cursor","pointer",3,"click"],[1,"body"],["boxchat2",""],[1,"p-2","list-unstyled","m-0"],["class","mb-2",3,"ngStyle",4,"ngFor","ngForOf"],[1,"footer","p-2","d-flex","align-items-center","justify-content-between",2,"border-top","1px solid #cfcfcf"],[4,"ngIf"],["style","display: flex; justify-content: center; align-items: center","class","locationPopup",4,"ngIf"],[1,"mb-2",3,"ngStyle"],["style","\n            border-radius: 15px;\n            padding: 10px;\n            display: inline-block;\n            max-width: 80%;\n            word-break: break-all;\n          ",3,"ngStyle",4,"ngIf"],["style","min-height: 100px",3,"ngStyle",4,"ngIf"],["style","display: flex",3,"ngStyle",4,"ngIf"],[2,"border-radius","15px","padding","10px","display","inline-block","max-width","80%","word-break","break-all",3,"ngStyle"],[2,"min-height","100px",3,"ngStyle"],["alt","Drasti",2,"max-height","200px","border","1px solid #cfcfcf","border-radius","10px","max-width","200px",3,"src"],[2,"display","flex",3,"ngStyle"],["controls","","controlsList","nodownload noplaybackrate",2,"width","90%"],["type","audio/mpeg",3,"src"],[3,"micError","send","nowRecording"],[1,"position-relative",2,"height","16px","width","16px"],[1,"fa-solid","fa-image","position-absolute"],["accept","image/*","type","file",2,"position","absolute","top","0","bottom","0","right","0","left","0","width","16px","height","16px","z-index","1","opacity","0",3,"input"],["placeholder","Aa","type","text",3,"keyup.enter"],["msgContent",""],[1,"fa-solid","fa-paper-plane",3,"click"],[1,"locationPopup",2,"display","flex","justify-content","center","align-items","center"],[2,"width","50%","background-color","white","border-radius","8px","padding","16px"],[2,"width","100%","display","flex","justify-content","end","margin-top","20px"],[1,"gotit",2,"background-color","#0034c2","color","white",3,"click"]],template:function(e,s){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"span",2),t._uU(3,"\u0627\u0644\u0631\u0633\u0627\u0626\u0644"),t.qZA(),t.TgZ(4,"i",3),t.NdJ("click",function(){return s.closeChat.emit()}),t.qZA()(),t.TgZ(5,"div",4,5)(7,"ul",6),t.YNc(8,tt,4,6,"li",7),t.qZA()(),t.TgZ(9,"div",8),t.YNc(10,et,2,0,"ng-container",9),t.YNc(11,it,7,0,"ng-container",9),t.qZA()(),t.YNc(12,st,9,0,"div",10)),2&e&&(t.xp6(8),t.Q6J("ngForOf",s.messages),t.xp6(2),t.Q6J("ngIf",s.showaudio),t.xp6(1),t.Q6J("ngIf",!s.nowRecording),t.xp6(1),t.Q6J("ngIf",s.micrphonAlert))},directives:[f.sg,f.PC,f.O5,L],styles:['.mat-radio-group:not(:last-of-type) .border-btm{padding-bottom:15px;border-bottom:1px solid #d4d1d1;margin-bottom:15px}  .accordion-toggle{padding:5px}  .accordion-toggle[aria-expanded=true]:after{font-family:"Font Awesome 5 Free";content:"\\f077";display:inline-block;padding-right:3px;vertical-align:middle;font-weight:900;position:absolute;color:#3052d8;left:20px;top:20px}  .card{padding:10px 0}  .card li{padding:20px 20px 0}  .card li i{color:#c2bec9}  .card li:not(:last-of-type){padding-bottom:20px}  .card.cstm li:last-of-type{padding-bottom:20px}  .card-header{border-bottom:none;background-color:transparent;padding:0}  .card-body{padding:0}  .accordion-toggle[aria-expanded=false]:after{font-family:"Font Awesome 5 Free";content:"\\f078";color:#3052d8;display:inline-block;padding-right:3px;vertical-align:middle;font-weight:900;position:absolute;left:20px;top:20px}  .btn-link{font-weight:500;color:#3052d8;text-decoration:none}  .btn.focus,   .btn:focus{box-shadow:none}  .btn-link:hover{color:#3052d8;text-decoration:none}  .swiper-button-next,   .swiper-button-prev{background:#0034c2!important;color:#fff!important;border-radius:50%!important;width:40px;height:40px;text-align:center;line-height:40px}  .swiper-button-next:after,   .swiper-button-prev:after{font-size:20px;font-weight:700}  .swiper-pagination-bullet-active{background-color:#0034c2!important}.cstmdel[_ngcontent-%COMP%]{font-size:35px;font-weight:500}@media only screen and (max-width: 768px){.cstmdel[_ngcontent-%COMP%]{font-size:20px}}.chatbox[_ngcontent-%COMP%]{position:fixed;bottom:0;left:20px;width:340px;border:1px solid #cfcfcf;background-color:#fff;border-top-left-radius:10px;border-top-right-radius:10px}.chatbox[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{height:50vh;overflow:auto}.chatbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:80%;border-radius:20px;border:none;background-color:#e6e8ec;outline:none;padding:5px 10px}.chatbox[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{cursor:pointer;color:#0034c2}@media only screen and (max-width: 600px){.chatbox[_ngcontent-%COMP%]{width:250px}}.locationPopup[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;overflow:auto;background-color:#00000080;z-index:1}.locationPopup[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #d6d4d4;padding:.7rem}.locationPopup[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{cursor:pointer;font-size:1.5rem}']}),i})();const ot=["boxchat"];function at(i,o){1&i&&t._UZ(0,"app-loading")}function lt(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"i",22),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return n.showNewChatBox=!1,n.showChatBox=!0,n.scrollChatBox()}),t.qZA()}}function ct(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"i",23),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).checkIfStudentBlocked()}),t.qZA()}}function rt(i,o){1&i&&(t.TgZ(0,"h3",24),t._uU(1,"\u0627\u0644\u0648\u0635\u0641"),t.qZA())}function dt(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"li",26),t.NdJ("click",function(){return t.CHM(e),t.oxw(3).attachOrClasses=2}),t._uU(1," \u0627\u0644\u0645\u0631\u0641\u0642\u0627\u062a "),t.qZA()}if(2&i){const e=t.oxw(3);t.ekj("active",2==e.attachOrClasses)}}function ut(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"ul",25)(1,"li",26),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).attachOrClasses=1}),t._uU(2," \u0627\u0644\u0645\u0627\u062f\u0629 \u0627\u0644\u062f\u0631\u0627\u0633\u064a\u0629 "),t.qZA(),t._UZ(3,"li",27),t.YNc(4,dt,2,2,"li",28),t.qZA()}if(2&i){const e=t.oxw(2);t.xp6(1),t.ekj("active",1==e.attachOrClasses),t.xp6(3),t.Q6J("ngIf",null==e.attchments?null:e.attchments.length)}}function pt(i,o){if(1&i&&(t.ynx(0),t.TgZ(1,"div",33),t._UZ(2,"i",34),t._uU(3),t.qZA(),t._UZ(4,"i",35),t.BQk()),2&i){const e=t.oxw().$implicit;t.xp6(3),t.hij(" ",null==e?null:e.name," ")}}const y=function(i,o,e){return["/subject-videos",i,o,e]};function _t(i,o){if(1&i&&(t.TgZ(0,"a",36),t._UZ(1,"i",34),t._uU(2),t.qZA()),2&i){const e=t.oxw().$implicit,s=t.oxw(4);t.Q6J("routerLink",t.kEZ(2,y,null==s.classDetails?null:s.classDetails.id,null==e?null:e.id,-1)),t.xp6(2),t.hij(" ",null==e?null:e.name," ")}}function gt(i,o){if(1&i&&(t.TgZ(0,"li",31),t.YNc(1,pt,5,1,"ng-container",1),t.YNc(2,_t,3,6,"a",32),t.qZA()),2&i){const e=t.oxw(4);t.xp6(1),t.Q6J("ngIf",!e.ispaid),t.xp6(1),t.Q6J("ngIf",e.ispaid)}}function ft(i,o){if(1&i&&(t.ynx(0),t.TgZ(1,"ul",29),t.YNc(2,gt,3,2,"li",30),t.qZA(),t.BQk()),2&i){const e=t.oxw(3);t.xp6(2),t.Q6J("ngForOf",e.lessons)}}function ht(i,o){1&i&&t._UZ(0,"i",35)}function mt(i,o){if(1&i&&(t.ynx(0),t.TgZ(1,"div",33),t._UZ(2,"i",34),t._uU(3),t.qZA(),t.YNc(4,ht,1,0,"i",42),t.BQk()),2&i){const e=t.oxw().$implicit,s=t.oxw(5);t.xp6(3),t.hij(" ",null==e?null:e.name," "),t.xp6(1),t.Q6J("ngIf",!s.ispaid)}}function xt(i,o){if(1&i&&(t.TgZ(0,"a",43),t._UZ(1,"i",34),t._uU(2),t.qZA()),2&i){const e=t.oxw().$implicit,s=t.oxw().$implicit,n=t.oxw(4);t.Q6J("routerLink",t.kEZ(2,y,null==n.classDetails?null:n.classDetails.id,null==e?null:e.id,null==s?null:s.id)),t.xp6(2),t.hij(" ",null==e?null:e.name," ")}}function vt(i,o){if(1&i&&(t.TgZ(0,"li",31),t.YNc(1,mt,5,2,"ng-container",1),t.YNc(2,xt,3,6,"a",41),t.qZA()),2&i){const e=t.oxw(5);t.xp6(1),t.Q6J("ngIf",!e.ispaid),t.xp6(1),t.Q6J("ngIf",e.ispaid)}}function bt(i,o){if(1&i&&(t.TgZ(0,"accordion",38)(1,"accordion-group",39)(2,"ul",40),t.YNc(3,vt,3,2,"li",30),t.qZA()()()),2&i){const e=o.$implicit,s=o.index;t.Q6J("isAnimated",!0),t.xp6(1),t.Q6J("isOpen",0==s)("heading",null==e?null:e.name),t.xp6(2),t.Q6J("ngForOf",null==e?null:e.lessons)}}function Ct(i,o){if(1&i&&(t.ynx(0),t.YNc(1,bt,4,4,"accordion",37),t.BQk()),2&i){const e=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",e.units)}}function yt(i,o){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,ft,3,1,"ng-container",1),t.YNc(2,Ct,2,1,"ng-container",1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",2==e.lessonsOrUnis&&(null==e.lessons?null:e.lessons.length)),t.xp6(1),t.Q6J("ngIf",1==e.lessonsOrUnis&&(null==e.units?null:e.units.length))}}function wt(i,o){if(1&i&&(t.TgZ(0,"li")(1,"a",47),t._UZ(2,"i",48),t._uU(3),t.qZA()()),2&i){const e=o.$implicit;t.xp6(1),t.Q6J("href",null==e?null:e.link,t.LSH),t.xp6(2),t.hij(" ",null==e?null:e.filename," ")}}function Dt(i,o){if(1&i&&(t.TgZ(0,"ul",40),t.YNc(1,wt,4,2,"li",46),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",e.attchments)}}function Tt(i,o){1&i&&(t.TgZ(0,"p",49),t._uU(1," \u0644\u0627 \u064a\u0648\u062c\u062f \u0645\u0631\u0641\u0642\u0627\u062a "),t.qZA())}function St(i,o){if(1&i&&(t.TgZ(0,"div")(1,"h2"),t._uU(2,"\u0627\u0644\u0645\u0631\u0641\u0642\u0627\u062a"),t.qZA(),t.YNc(3,Dt,2,1,"ul",44),t.YNc(4,Tt,2,0,"p",45),t.qZA()),2&i){const e=t.oxw(2);t.xp6(3),t.Q6J("ngIf",null==e.attchments?null:e.attchments.length),t.xp6(1),t.Q6J("ngIf",!(null!=e.attchments&&e.attchments.length))}}function Zt(i,o){if(1&i&&(t.TgZ(0,"video",50),t._UZ(1,"source",51)(2,"source",52),t._uU(3," Your browser does not support the video tag. "),t.qZA()),2&i){const e=t.oxw(2);t.Q6J("cachedSrc",null==e.classDetails?null:e.classDetails.video_upload)}}function It(i,o){if(1&i&&t._UZ(0,"iframe",53),2&i){const e=t.oxw(2);t.Q6J("cachedSrc",(null==e.classDetails?null:e.classDetails.video_url)||(null==e.classDetails?null:e.classDetails.video_vimeo_url))}}function At(i,o){if(1&i&&t._UZ(0,"iframe",53),2&i){const e=t.oxw(2);t.Q6J("cachedSrc",e.savedYoutube(null==e.classDetails?null:e.classDetails.video_youtube))}}function kt(i,o){if(1&i&&t._UZ(0,"img",54),2&i){const e=t.oxw(2);t.Q6J("src",null==e.classDetails?null:e.classDetails.media,t.LSH)}}function Mt(i,o){if(1&i&&(t.TgZ(0,"div",57)(1,"bdi",58),t._uU(2),t.qZA(),t.TgZ(3,"del",58),t._uU(4),t.qZA()()),2&i){const e=t.oxw(3);t.xp6(2),t.hij(" ",null==e.classDetails?null:e.classDetails.discount," \u062f.\u0643 "),t.xp6(2),t.hij(" ",null==e.classDetails?null:e.classDetails.price," \u062f.\u0643 ")}}function Jt(i,o){if(1&i&&(t.TgZ(0,"div",59)(1,"bdi",58),t._uU(2),t.qZA()()),2&i){const e=t.oxw(3);t.xp6(2),t.hij("",null==e.classDetails?null:e.classDetails.price,"\u062f.\u0643")}}function Qt(i,o){if(1&i&&(t.ynx(0),t.YNc(1,Mt,5,2,"div",55),t.YNc(2,Jt,3,1,"div",56),t.BQk()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",null==e.classDetails?null:e.classDetails.discount),t.xp6(1),t.Q6J("ngIf",!(null!=e.classDetails&&e.classDetails.discount))}}function Nt(i,o){if(1&i&&(t.TgZ(0,"div",61)(1,"a",62),t._uU(2," \u0627\u0633\u062a\u0645\u0631\u0627\u0631 \u0641\u064a \u0627\u0644\u0645\u0630\u0627\u0643\u0631\u0629 "),t.qZA()()),2&i){const e=t.oxw(3);t.xp6(1),t.Q6J("routerLink",t.kEZ(1,y,null==e.classDetails?null:e.classDetails.id,-1,-1))}}function Ot(i,o){if(1&i&&(t.ynx(0),t.YNc(1,Nt,3,5,"div",60),t.BQk()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.ispaid)}}function jt(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",66),t.NdJ("click",function(){return t.CHM(e),t.oxw(3).pushCartIds()}),t._UZ(1,"i",67),t._uU(2," \u0627\u0636\u0627\u0641\u0629 \u0627\u0644\u064a \u0627\u0644\u0633\u0644\u0629 "),t.qZA()}}function Ut(i,o){1&i&&(t.TgZ(0,"a",68),t._uU(1," \u0639\u0631\u0636 \u0627\u0644\u0633\u0644\u0629 "),t.qZA())}function Yt(i,o){if(1&i&&(t.TgZ(0,"div",63),t.YNc(1,jt,3,0,"button",64),t.YNc(2,Ut,2,0,"a",65),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!e.cart),t.xp6(1),t.Q6J("ngIf",e.cart)}}function Ft(i,o){1&i&&(t.TgZ(0,"h2"),t._uU(1,"\u0627\u0644\u0645\u0648\u0627\u062f"),t.qZA())}function Rt(i,o){if(1&i&&(t.TgZ(0,"div",71)(1,"div"),t._UZ(2,"app-cart",72),t.qZA()()),2&i){const e=o.$implicit;t.xp6(2),t.Q6J("small",!0)("showaddButton",!0)("addeddTocart",null==e?null:e.cart)("classid",-1)("speid",-1)("id",null==e?null:e.id)("imgSrc",null==e?null:e.media)("name",null==e?null:e.name)("price",null==e?null:e.price)("discount",null==e?null:e.discount)("paid",null==e?null:e.is_paid)}}function Ht(i,o){if(1&i&&(t.ynx(0),t.YNc(1,Ft,2,0,"h2",1),t.TgZ(2,"div",69),t.YNc(3,Rt,3,11,"div",70),t.qZA(),t.BQk()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!e.loading&&(null==e.offerSubjects?null:e.offerSubjects.length)),t.xp6(2),t.Q6J("ngForOf",e.offerSubjects)}}function qt(i,o){if(1&i&&(t.TgZ(0,"div",5)(1,"div",6),t.YNc(2,lt,1,0,"i",7),t.YNc(3,ct,1,0,"i",8),t.qZA(),t.TgZ(4,"div",9)(5,"div",10)(6,"div",11)(7,"h2",12),t._uU(8),t.qZA(),t._UZ(9,"hr"),t.YNc(10,rt,2,0,"h3",13),t._UZ(11,"div",14),t.YNc(12,ut,5,3,"ul",15),t.YNc(13,yt,3,2,"div",1),t.YNc(14,St,5,2,"div",1),t.qZA()(),t.TgZ(15,"div",16)(16,"div",17),t.YNc(17,Zt,4,1,"video",18),t.YNc(18,It,1,1,"iframe",19),t.YNc(19,At,1,1,"iframe",19),t.YNc(20,kt,1,1,"img",20),t.YNc(21,Qt,3,2,"ng-container",1),t.YNc(22,Ot,2,1,"ng-container",1),t.YNc(23,Yt,3,2,"div",21),t.qZA()()(),t.YNc(24,Ht,4,2,"ng-container",1),t.qZA()),2&i){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.islogin()&&(null==e.classDetails?null:e.classDetails.is_paid)&&(null==e.classDetails?null:e.classDetails.has_chat)&&"offer"!=e.type&&0==e.showChatBox),t.xp6(1),t.Q6J("ngIf",e.islogin()&&(null==e.classDetails?null:e.classDetails.is_paid)&&(null==e.classDetails?null:e.classDetails.has_chat)&&(null==e.classDetails?null:e.classDetails.can_question)&&"offer"!=e.type&&0==e.showNewChatBox),t.xp6(5),t.Oqu(null==e.classDetails?null:e.classDetails.name),t.xp6(2),t.Q6J("ngIf",null==e.classDetails?null:e.classDetails.description),t.xp6(1),t.Q6J("innerText",null==e.classDetails?null:e.classDetails.description),t.xp6(1),t.Q6J("ngIf","offer"!=e.type),t.xp6(1),t.Q6J("ngIf",1==e.attachOrClasses&&"offer"!=e.type),t.xp6(1),t.Q6J("ngIf",2==e.attachOrClasses&&"offer"!=e.type),t.xp6(3),t.Q6J("ngIf","upload"==(null==e.classDetails?null:e.classDetails.video_type)),t.xp6(1),t.Q6J("ngIf","videocipher"==(null==e.classDetails?null:e.classDetails.video_type)||"vimeo"==(null==e.classDetails?null:e.classDetails.video_type)),t.xp6(1),t.Q6J("ngIf","youtube"==(null==e.classDetails?null:e.classDetails.video_type)),t.xp6(1),t.Q6J("ngIf","videocipher"!=(null==e.classDetails?null:e.classDetails.video_type)&&"youtube"!=(null==e.classDetails?null:e.classDetails.video_type)&&"vimeo"!=(null==e.classDetails?null:e.classDetails.video_type)&&"upload"!=(null==e.classDetails?null:e.classDetails.video_type)),t.xp6(1),t.Q6J("ngIf",!e.ispaid),t.xp6(1),t.Q6J("ngIf","offer"!=e.type),t.xp6(1),t.Q6J("ngIf",!e.ispaid),t.xp6(1),t.Q6J("ngIf","offer"==e.type)}}const Bt=function(i,o){return{background:i,color:o}};function Pt(i,o){if(1&i&&(t.TgZ(0,"span",92),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit,s=t.oxw(2);t.Q6J("ngStyle",t.WLB(2,Bt,s.userid==(null==e?null:e.from_id)?"#0d6efd":"#e4e6eb",s.userid==(null==e?null:e.from_id)?"white":"black")),t.xp6(1),t.hij(" ",null==e?null:e.message_content," ")}}function $t(i,o){if(1&i&&t._UZ(0,"img",93),2&i){const e=t.oxw().$implicit;t.Q6J("src",null==e?null:e.message_content,t.LSH)}}const M=function(i){return{"text-align":i}};function Et(i,o){if(1&i&&(t.TgZ(0,"li",88),t.YNc(1,Pt,2,5,"span",89),t.TgZ(2,"div",90),t.YNc(3,$t,1,1,"img",91),t.qZA()()),2&i){const e=o.$implicit,s=t.oxw(2);t.Q6J("ngStyle",t.VKq(4,M,s.userid==(null==e?null:e.from_id)?"left":"right")),t.xp6(1),t.Q6J("ngIf","text"==(null==e?null:e.type)),t.xp6(1),t.Q6J("ngStyle",t.VKq(6,M,s.userid==(null==e?null:e.from_id)?"left":"right")),t.xp6(1),t.Q6J("ngIf","photo"==(null==e?null:e.type))}}function Lt(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"div",73)(1,"div",74)(2,"span",75),t._uU(3,"\u0627\u0644\u0631\u0633\u0627\u0626\u0644"),t.qZA(),t.TgZ(4,"i",76),t.NdJ("click",function(){return t.CHM(e),t.oxw().showChatBox=!1}),t.qZA()(),t.TgZ(5,"div",77,78)(7,"ul",79),t.YNc(8,Et,4,8,"li",80),t.qZA()(),t.TgZ(9,"div",81)(10,"div",82),t._UZ(11,"i",83),t.TgZ(12,"input",84),t.NdJ("input",function(n){return t.CHM(e),t.oxw().onImageChange(n)}),t.qZA()(),t.TgZ(13,"input",85,86),t.NdJ("keyup.enter",function(){t.CHM(e);const n=t.MAs(14);return t.oxw().sendMessage(n)}),t.qZA(),t.TgZ(15,"i",87),t.NdJ("click",function(){t.CHM(e);const n=t.MAs(14);return t.oxw().sendMessage(n)}),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(8),t.Q6J("ngForOf",e.messages)}}function zt(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"app-subject-chat",94),t.NdJ("closeChat",function(){return t.CHM(e),t.oxw().showNewChatBox=!1}),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("classDetails",e.classDetails)}}v.ZP.use([v.W_,v.tl]);const Vt=[{path:"",component:(()=>{class i{constructor(e,s,n,l,a,c,r,d,u,g,h,m){this.toastr=e,this.classdetailsService=s,this.angularFireStore=n,this.datepipe=l,this.afs=a,this._sanitizer=c,this.title=r,this.cartService=d,this.subjectsService=u,this.ref=g,this.router=h,this.activatedRoute=m,this.showChatBox=!1,this.showNewChatBox=!1,this.messages=[],this.swpieroptions={slidesPerView:3,spaceBetween:"50",pagination:!1,navigation:"true",breakpoints:{0:{slidesPerView:1,spaceBetween:10},768:{slidesPerView:2,spaceBetween:10},1024:{slidesPerView:5,spaceBetween:40}}},this.offerSubjects=[],this.classDetails={},this.ispaid=!1,this.loading=!0,this.lessons=[],this.units=[],this.lessonsOrUnis=0,this.type="",this.cart=!1,this.cartitems=[],this.attachOrClasses=1,this.attchments=[]}scrollChatBox(){setTimeout(()=>{this.boxchat&&(this.boxchat.nativeElement.scrollTop=this.boxchat.nativeElement.scrollHeight)},10)}onImageChange(e){var s;const n=null===(s=null==e?void 0:e.target)||void 0===s?void 0:s.files[0];let l=this.angularFireStore.ref(`message_images/photo_message_${this.datepipe.transform(new Date,"yyyy-MM-dd HH:mm:ss")}`);l.put(n).then(()=>{l.getDownloadURL().subscribe(a=>{var c;let r=new Date;(0,p.t8)((0,p.iH)(this.db,`Messages/${this.classid}/${localStorage.getItem("userid")}/${this.afs.createId()}`),{date:this.datepipe.transform(r,"yyyy-MM-dd HH:mm:ss"),from:localStorage.getItem("username"),from_id:localStorage.getItem("userid"),message_content:a,to:null===(c=this.classDetails)||void 0===c?void 0:c.name,to_id:this.classid,type:"photo"})})})}ngOnInit(){this.app=(0,S.ZF)({apiKey:"AIzaSyCrZO0tF5O5Ms8au460-tmGbNS3mJ6QrEc",authDomain:"drasti-37a06.firebaseapp.com",databaseURL:"https://drasti-37a06-default-rtdb.firebaseio.com",projectId:"drasti-37a06",storageBucket:"drasti-37a06.appspot.com",messagingSenderId:"850147128578",appId:"1:850147128578:web:2153add74417b85d4fbe1b",measurementId:"G-41JEDDFQT2"}),this.db=(0,p.N8)(this.app),window.scroll(0,0),this.title.setTitle(" \u062f\u0631\u0627\u0633\u062a\u064a - \u0627\u062f\u0631\u0633 \u0648\u0627\u0646\u062a \u0645\u062a\u0637\u0645\u0646 "),this.activatedRoute.params.subscribe(e=>{var s,n;this.classid=null==e?void 0:e.id;const l=(0,p.iH)(this.db,`Messages/${this.classid}/${localStorage.getItem("userid")}`);(0,p.jM)(l,a=>{if(this.messages=[],localStorage.getItem("drastitoken")){let r=a.val();if(r){let d=null;d=r,d&&(this.messages=Object.values(d),this.messages=this.messages.sort(function(u,g){return new Date(u.date)-new Date(g.date)}))}setTimeout(()=>{this.boxchat&&(this.boxchat.nativeElement.scrollTop=this.boxchat.nativeElement.scrollHeight)},10)}}),this.loading=!0,this.type=null==e?void 0:e.type,"offer"==(null==e?void 0:e.type)?-1==(null==e?void 0:e.spe)?null===(s=this.subjectsService.getOffer(null==e?void 0:e.class))||void 0===s||s.subscribe(a=>{var c,r,d,u;(null===(c=null==a?void 0:a.data)||void 0===c?void 0:c.length)&&Array.isArray(null==a?void 0:a.data)&&(this.classDetails=null==a?void 0:a.data.find(g=>(null==g?void 0:g.id)==(null==e?void 0:e.id)),this.classDetails.speid=-1,this.offerSubjects=null===(r=this.classDetails)||void 0===r?void 0:r.materials,this.ispaid=null===(d=this.classDetails)||void 0===d?void 0:d.is_paid),this.title.setTitle(null===(u=this.classDetails)||void 0===u?void 0:u.name),this.getCart(),this.loading=!1}):null===(n=this.subjectsService.getOfferWithSpecialist(null==e?void 0:e.class,null==e?void 0:e.spe))||void 0===n||n.subscribe(a=>{var c,r,d;(null===(c=null==a?void 0:a.data)||void 0===c?void 0:c.length)&&Array.isArray(null==a?void 0:a.data)&&(this.classDetails=null==a?void 0:a.data.find(u=>(null==u?void 0:u.id)==(null==e?void 0:e.id)),this.offerSubjects=null===(r=this.classDetails)||void 0===r?void 0:r.materials,this.ispaid=null===(d=this.classDetails)||void 0===d?void 0:d.is_paid),this.getCart(),this.loading=!1}):(this.offerSubjects=[],this.classdetailsService.getClassDetails(null==e?void 0:e.id).subscribe(a=>{var c,r,d,u,g,h,m,w,D;this.classDetails=null==a?void 0:a.data,this.classDetails.speid=null==e?void 0:e.spe,this.ispaid=null===(c=null==a?void 0:a.data)||void 0===c?void 0:c.is_paid,this.attchments=this.ispaid?[...null===(r=null==a?void 0:a.data)||void 0===r?void 0:r.public_attachment,...null===(d=null==a?void 0:a.data)||void 0===d?void 0:d.private_attachment]:null===(u=null==a?void 0:a.data)||void 0===u?void 0:u.public_attachment,this.title.setTitle(null===(g=this.classDetails)||void 0===g?void 0:g.name),(null===(h=this.classDetails)||void 0===h?void 0:h.has_units)?(this.lessonsOrUnis=1,this.getUnits(null===(m=this.classDetails)||void 0===m?void 0:m.id)):(null===(w=this.classDetails)||void 0===w?void 0:w.has_lessons)&&(this.lessonsOrUnis=2,this.getLessons(null===(D=this.classDetails)||void 0===D?void 0:D.id)),"true"==this.activatedRoute.snapshot.queryParams.openChat&&(this.showNewChatBox=!0),this.loading=!1,this.getCart()}))})}savedYoutube(e){if(e)return`https://www.youtube.com/embed/${e.slice(e.indexOf("v=")+2,e.lastIndexOf("&"))}`}savedHtml(e){return this._sanitizer.bypassSecurityTrustHtml(e)}getCart(){this.cartService.cartItems.subscribe(e=>{e&&(this.cartitems=e,this.cartitems.forEach("offer"!=this.type?s=>{var n,l;(null===(n=this.classDetails)||void 0===n?void 0:n.id)==(null===(l=null==s?void 0:s.material)||void 0===l?void 0:l.id)&&(this.cart=!0)}:s=>{var n,l;(null===(n=this.classDetails)||void 0===n?void 0:n.id)==(null===(l=null==s?void 0:s.offer)||void 0===l?void 0:l.id)&&(this.cart=!0)}))})}getUnits(e){this.classdetailsService.classUnites(e).subscribe(s=>{this.units=null==s?void 0:s.data})}getLessons(e){this.classdetailsService.classLessons(e).subscribe(s=>{this.lessons=null==s?void 0:s.data})}pushCartIds(){var e,s;"offer"==this.type?localStorage.getItem("drastitoken")?(this.loading=!0,this.cartService.addToCart({offer_ids:[null===(e=this.classDetails)||void 0===e?void 0:e.id],material_ids:[]}).subscribe(n=>{this.cart=!0,this.cartService.getCart(),this.loading=!1},n=>{this.loading=!1})):(this.cartitems.push({has_offer:!0,offer:this.classDetails}),this.cartService.cartItems.next(this.cartitems),this.cart=!0,this.getCart()):"subject"==this.type&&(localStorage.getItem("drastitoken")?(this.loading=!0,this.cartService.addToCart({material_ids:[null===(s=this.classDetails)||void 0===s?void 0:s.id],offer_ids:[]}).subscribe(n=>{this.cart=!0,this.cartService.getCart(),this.loading=!1},n=>{this.loading=!1})):(this.cartitems.push({has_material:!0,material:this.classDetails}),this.cartService.cartItems.next(this.cartitems),this.cart=!0,this.getCart()))}get userid(){return localStorage.getItem("userid")}islogin(){return!!localStorage.getItem("drastitoken")}sendMessage(e){var s;let n=e.value;if(n.toString().trim().length>0){let l=new Date;(0,p.t8)((0,p.iH)(this.db,`Messages/${this.classid}/${localStorage.getItem("userid")}/${this.afs.createId()}`),{date:this.datepipe.transform(l,"yyyy-MM-dd HH:mm:ss"),from:localStorage.getItem("username"),from_id:localStorage.getItem("userid"),message_content:n,to:null===(s=this.classDetails)||void 0===s?void 0:s.name,to_id:this.classid,type:"text"}),e.value=""}}checkIfStudentBlocked(){var e;(null===(e=this.classDetails)||void 0===e?void 0:e.is_blocked)?this.toastr.error("\u062a\u0645 \u062d\u0638\u0631\u0643 \u0645\u0646 \u0627\u0631\u0633\u0627\u0644 \u0627\u0644\u0631\u0633\u0627\u0626\u0644"):(this.showChatBox=!1,this.showNewChatBox=!0)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(J._W),t.Y36(Z._),t.Y36(I.Q1),t.Y36(f.uU),t.Y36(A.ST),t.Y36(b.H7),t.Y36(b.Dx),t.Y36(Q.N),t.Y36(N.n),t.Y36(t.sBO),t.Y36(x.F0),t.Y36(x.gz))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-class-details"]],viewQuery:function(e,s){if(1&e&&t.Gf(ot,5),2&e){let n;t.iGM(n=t.CRH())&&(s.boxchat=n.first)}},decls:5,vars:4,consts:[[1,"class-details","pt-5",2,"min-height","100vh"],[4,"ngIf"],["class","container",4,"ngIf"],["class","chatbox",4,"ngIf"],[3,"classDetails","closeChat",4,"ngIf"],[1,"container"],[2,"color","#b1b8c9","font-size","30px","position","fixed","bottom","20px","right","20px","z-index","11111111111","display","flex","flex-direction","column","gap","10px"],["title","\u0627\u0644\u062f\u0639\u0645 \u0627\u0644\u0641\u0646\u064a","style","cursor: pointer","class","fa-solid fa-envelope",3,"click",4,"ngIf"],["title","\u0627\u0633\u0623\u0644 \u062f\u0631\u0627\u0633\u062a\u064a","style","cursor: pointer","class","fa-solid fa-message",3,"click",4,"ngIf"],[1,"row"],[1,"col-lg-8","mb-5","order-2","order-lg-1"],[1,"contentDescription","bg-white","rounded","p-3","p-md-5"],[1,"mb-5"],["class","my-4",4,"ngIf"],[1,"mb-4",3,"innerText"],["class","p-0 list-unstyled d-flex attach",4,"ngIf"],[1,"col-lg-4","mb-5","order-1","order-lg-2"],[1,"bg-white","text-center","rounded","overflow-hidden"],["controls","","controlslist","nodownload","preload","metadata","playsinline","","style","width: 100%","height","360","controls","",3,"cachedSrc",4,"ngIf"],["allow","encrypted-media","allowFullScreen","true","class","w-100","style","height: 360px",3,"cachedSrc",4,"ngIf"],["class","w-100","alt","\u062f\u0631\u0627\u0633\u062a\u064a",3,"src",4,"ngIf"],["class","pb-3 px-3",4,"ngIf"],["title","\u0627\u0644\u062f\u0639\u0645 \u0627\u0644\u0641\u0646\u064a",1,"fa-solid","fa-envelope",2,"cursor","pointer",3,"click"],["title","\u0627\u0633\u0623\u0644 \u062f\u0631\u0627\u0633\u062a\u064a",1,"fa-solid","fa-message",2,"cursor","pointer",3,"click"],[1,"my-4"],[1,"p-0","list-unstyled","d-flex","attach"],[3,"click"],[1,"mx-2"],[3,"active","click",4,"ngIf"],[1,"p-0","list-unstyled","card","cstm"],["class","d-flex justify-content-between align-items-center","style","border-top: 1px solid #c2bec9",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between","align-items-center",2,"border-top","1px solid #c2bec9"],[3,"routerLink",4,"ngIf"],[1,"w-57"],[1,"fa-solid","fa-book"],[1,"fa-solid","fa-lock"],[3,"routerLink"],["class","mb-4",3,"isAnimated",4,"ngFor","ngForOf"],[1,"mb-4",3,"isAnimated"],[3,"isOpen","heading"],[1,"p-0","list-unstyled"],["style","color: #1b52d8 !important; font-weight: bold",3,"routerLink",4,"ngIf"],["class","fa-solid fa-lock",4,"ngIf"],[2,"color","#1b52d8 !important","font-weight","bold",3,"routerLink"],["class","p-0 list-unstyled",4,"ngIf"],["class","text-center text-secondary fw-bold",4,"ngIf"],[4,"ngFor","ngForOf"],["target","_blank",1,"attachLinks",3,"href"],[1,"fa-solid","fa-file"],[1,"text-center","text-secondary","fw-bold"],["controls","","controlslist","nodownload","preload","metadata","playsinline","","height","360","controls","",2,"width","100%",3,"cachedSrc"],["src","movie.mp4","type","video/mp4"],["src","movie.ogg","type","video/ogg"],["allow","encrypted-media","allowFullScreen","true",1,"w-100",2,"height","360px",3,"cachedSrc"],["alt","\u062f\u0631\u0627\u0633\u062a\u064a",1,"w-100",3,"src"],["style","text-align: left; direction: ltr","class","d-flex flex-wrap justify-content-between align-items-center p-3",4,"ngIf"],["class","p-3","style","text-align: left !important",4,"ngIf"],[1,"d-flex","flex-wrap","justify-content-between","align-items-center","p-3",2,"text-align","left","direction","ltr"],[1,"cstmdel",2,"color","#4b5981"],[1,"p-3",2,"text-align","left !important"],["class","pb-3 px-3 my-2 text-center",4,"ngIf"],[1,"pb-3","px-3","my-2","text-center"],[1,"bluButton","d-inline-block",2,"border-radius","5px",3,"routerLink"],[1,"pb-3","px-3"],["class","w-100 btn btn-primary",3,"click",4,"ngIf"],["routerLink","/cart","style","font-weight: bold; border-radius: 5px; font-size: 18px","class","bluButton text-center d-block",4,"ngIf"],[1,"w-100","btn","btn-primary",3,"click"],[1,"fa-solid","fa-cart-shopping"],["routerLink","/cart",1,"bluButton","text-center","d-block",2,"font-weight","bold","border-radius","5px","font-size","18px"],[1,"row","mrginBottom"],["class","col-6 col-lg-4 col-xl-3 mb-4",4,"ngFor","ngForOf"],[1,"col-6","col-lg-4","col-xl-3","mb-4"],["type","subject",3,"small","showaddButton","addeddTocart","classid","speid","id","imgSrc","name","price","discount","paid"],[1,"chatbox"],[1,"header","px-3","py-2","d-flex","align-items-center","justify-content-between",2,"border-bottom","1px solid #cfcfcf"],[1,"fw-bold"],[1,"fa-solid","fa-x",2,"cursor","pointer",3,"click"],[1,"body"],["boxchat",""],[1,"p-2","list-unstyled","m-0"],["class","mb-2",3,"ngStyle",4,"ngFor","ngForOf"],[1,"footer","p-2","d-flex","align-items-center","justify-content-between",2,"border-top","1px solid #cfcfcf"],[1,"position-relative",2,"height","16px","width","16px"],[1,"fa-solid","fa-image","position-absolute"],["accept","image/*","type","file",2,"position","absolute","top","0","bottom","0","right","0","left","0","width","16px","height","16px","z-index","1","opacity","0",3,"input"],["placeholder","Aa","type","text",3,"keyup.enter"],["msgContent",""],[1,"fa-solid","fa-paper-plane",3,"click"],[1,"mb-2",3,"ngStyle"],["style","\n            border-radius: 15px;\n            padding: 10px;\n            display: inline-block;\n            max-width: 80%;\n            word-break: break-all;\n          ",3,"ngStyle",4,"ngIf"],[3,"ngStyle"],["style","\n              max-height: 200px;\n              border: 1px solid #cfcfcf;\n              border-radius: 10px;\n              max-width: 200px;\n            ","alt","Drasti",3,"src",4,"ngIf"],[2,"border-radius","15px","padding","10px","display","inline-block","max-width","80%","word-break","break-all",3,"ngStyle"],["alt","Drasti",2,"max-height","200px","border","1px solid #cfcfcf","border-radius","10px","max-width","200px",3,"src"],[3,"classDetails","closeChat"]],template:function(e,s){1&e&&(t.TgZ(0,"section",0),t.YNc(1,at,1,0,"app-loading",1),t.YNc(2,qt,25,16,"div",2),t.qZA(),t.YNc(3,Lt,16,1,"div",3),t.YNc(4,zt,1,1,"app-subject-chat",4)),2&e&&(t.xp6(1),t.Q6J("ngIf",s.loading),t.xp6(1),t.Q6J("ngIf",!s.loading),t.xp6(1),t.Q6J("ngIf",s.showChatBox),t.xp6(1),t.Q6J("ngIf",s.showNewChatBox))},directives:[f.O5,O.N,f.sg,x.yS,C.Zf,C.U_,j.s,U.P,f.PC,nt],styles:['.mat-radio-group:not(:last-of-type) .border-btm{padding-bottom:15px;border-bottom:1px solid #d4d1d1;margin-bottom:15px}  .accordion-toggle{padding:5px}  .accordion-toggle[aria-expanded=true]:after{font-family:"Font Awesome 5 Free";content:"\\f077";display:inline-block;padding-right:3px;vertical-align:middle;font-weight:900;position:absolute;color:#3052d8;left:20px;top:20px}  .card{padding:10px 0}  .card li{padding:20px 20px 0}  .card li i{color:#c2bec9}  .card li:not(:last-of-type){padding-bottom:20px}  .card.cstm li:last-of-type{padding-bottom:20px}  .card-header{border-bottom:none;background-color:transparent;padding:0}  .card-body{padding:0}  .accordion-toggle[aria-expanded=false]:after{font-family:"Font Awesome 5 Free";content:"\\f078";color:#3052d8;display:inline-block;padding-right:3px;vertical-align:middle;font-weight:900;position:absolute;left:20px;top:20px}  .btn-link{font-weight:500;color:#3052d8;text-decoration:none}  .btn.focus,   .btn:focus{box-shadow:none}  .btn-link:hover{color:#3052d8;text-decoration:none}  .swiper-button-next,   .swiper-button-prev{background:#0034C2!important;color:#fff!important;border-radius:50%!important;width:40px;height:40px;text-align:center;line-height:40px}  .swiper-button-next:after,   .swiper-button-prev:after{font-size:20px;font-weight:700}  .swiper-pagination-bullet-active{background-color:#0034c2!important}.cstmdel[_ngcontent-%COMP%]{font-size:35px;font-weight:500}@media only screen and (max-width: 768px){.cstmdel[_ngcontent-%COMP%]{font-size:20px}}.chatbox[_ngcontent-%COMP%]{position:fixed;bottom:0;left:20px;width:340px;border:1px solid #cfcfcf;background-color:#fff;border-top-left-radius:10px;border-top-right-radius:10px}.chatbox[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{height:50vh;overflow:auto}.chatbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:80%;border-radius:20px;border:none;background-color:#e6e8ec;outline:none;padding:5px 10px}.chatbox[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{cursor:pointer;color:#0034c2}@media only screen and (max-width: 600px){.chatbox[_ngcontent-%COMP%]{width:250px}}']}),i})()}];let Gt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[x.Bz.forChild(Vt)],x.Bz]}),i})();var Kt=_(4466);let Wt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[f.ez,Gt,C.fx.forRoot(),Kt.m]]}),i})()}}]);