"use strict";(self.webpackChunkdrasti=self.webpackChunkdrasti||[]).push([[193],{6193:(C,m,n)=>{n.r(m),n.d(m,{AllMsgsModule:()=>N});var l=n(9808),r=n(6115),i=n(6197),t=n(5e3),c=n(4884),f=n(8424);function M(s,a){1&s&&(t.TgZ(0,"div",6),t._uU(1," \u0644\u0627 \u062a\u0648\u062c\u062f \u0645\u0648\u0627\u062f \u0628\u0647\u0627 \u0631\u0633\u0627\u0626\u0644 \u0628\u0639\u062f. "),t.qZA())}function A(s,a){1&s&&(t.TgZ(0,"span",11),t._uU(1,"\u25cf"),t.qZA())}const x=function(){return{openChat:!0}};function y(s,a){if(1&s&&(t.TgZ(0,"div",7)(1,"div",8),t._uU(2),t._UZ(3,"span",9),t.YNc(4,A,2,0,"span",10),t.qZA()()),2&s){const e=a.$implicit;t.xp6(1),t.Q6J("queryParams",t.DdM(4,x))("routerLink","/class-details/"+(null==e?null:e.materialId)+"/subject/-1/-1"),t.xp6(1),t.hij(" ",e.materialName," "),t.xp6(2),t.Q6J("ngIf",e.hasUnread)}}function I(s,a){if(1&s&&(t.TgZ(0,"div",2)(1,"h1",3),t._uU(2," \u062c\u0645\u064a\u0639 \u0627\u0644\u0631\u0633\u0627\u0626\u0644 "),t.qZA(),t.YNc(3,M,2,0,"div",4),t.YNc(4,y,5,5,"div",5),t.qZA()),2&s){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",0===e.materialChats.length),t.xp6(1),t.Q6J("ngForOf",e.materialChats)}}function T(s,a){1&s&&t._UZ(0,"app-loading")}const _=[{path:"",component:(()=>{class s{constructor(e){this.myCoursesService=e,this.loading=!0,this.studentId=localStorage.getItem("userid")||"",this.materialChats=[],this.classes=[],this.listeners=[]}ngOnInit(){this.myCoursesService.getMyCourses().subscribe(e=>{var d;this.classes=null==e?void 0:e.data.filter(o=>null==o.offer),this.classes=this.classes.map(o=>o.material),(null===(d=null==e?void 0:e.data)||void 0===d?void 0:d.length)||(this.loading=!1),this.classes.forEach(o=>{const U=`Subjects-Messages/${o.id}/${this.studentId}`,h=(0,i.iH)((0,i.N8)(),U);this.listeners.push(h);const u={latest:"",hasUnread:!1};(0,i.yv)(h,O=>{const g=O.val(),b=new Date(g.date).getTime();(!u.latest||b>new Date(u.latest).getTime())&&(u.latest=g.date),g.from_id!==this.studentId&&!1===g.did_read&&(u.hasUnread=!0);const v=this.materialChats.findIndex(p=>p.materialId===o.id);-1!==v?this.materialChats[v]=Object.assign({materialId:o.id,materialName:o.name},u):this.materialChats.push(Object.assign({materialId:o.id,materialName:o.name},u)),this.materialChats.sort((p,D)=>new Date(D.latest).getTime()-new Date(p.latest).getTime()),this.loading=!1})})})}ngOnDestroy(){this.listeners.forEach(e=>(0,i.S1)(e))}}return s.\u0275fac=function(e){return new(e||s)(t.Y36(c.b))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-all-msgs"]],decls:2,vars:2,consts:[["class","container",4,"ngIf"],[4,"ngIf"],[1,"container"],[2,"text-align","center","color","#0034c2","margin-bottom","20px"],["style","font-weight: bold",4,"ngIf"],["class","material-item",4,"ngFor","ngForOf"],[2,"font-weight","bold"],[1,"material-item"],[1,"material-name",2,"background","#2b6cb0","color","white","padding","10px","border-radius","10px","margin-bottom","16px","cursor","pointer",3,"queryParams","routerLink"],[1,"mx-5"],["class","unread-dot",4,"ngIf"],[1,"unread-dot"]],template:function(e,d){1&e&&(t.YNc(0,I,5,2,"div",0),t.YNc(1,T,1,0,"app-loading",1)),2&e&&(t.Q6J("ngIf",!d.loading),t.xp6(1),t.Q6J("ngIf",d.loading))},directives:[l.O5,l.sg,r.rH,f.N],styles:[""]}),s})()}];let Z=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[[r.Bz.forChild(_)],r.Bz]}),s})();var F=n(4466);let N=(()=>{class s{}return s.\u0275fac=function(e){return new(e||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[[l.ez,Z,F.m]]}),s})()},8424:(C,m,n)=>{n.d(m,{N:()=>r});var l=n(5e3);let r=(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(c){return new(c||i)},i.\u0275cmp=l.Xpm({type:i,selectors:[["app-loading"]],decls:6,vars:0,consts:[[2,"height","300px","display","flex","justify-content","center","align-items","center"],[1,"lds-ring"]],template:function(c,f){1&c&&(l.TgZ(0,"div",0)(1,"div",1),l._UZ(2,"div")(3,"div")(4,"div")(5,"div"),l.qZA()())},styles:[""]}),i})()}}]);